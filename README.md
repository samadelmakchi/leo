# LEO - Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ù„ÛŒØ¨Ø±ÛŒ

ÛŒÚ© Ø³ÛŒØ³ØªÙ… CI/CD Ú©Ø§Ù…Ù„Ø§Ù‹ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙ‚Ø±Ø§Ø±ØŒ Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø¨Ú©Ø§Ù¾â€ŒÚ¯ÛŒØ±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ **Gateway + Portal + Portal-Frontend** Ø¨Ø§ Docker Compose Ùˆ Ansible.

### ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ
- Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ (ÙÙ‚Ø· gatewayØŒ ÙÙ‚Ø· frontend Ùˆ ...)
- Ø­Ø§Ù„Øª Ú©Ø§Ù…Ù„ `up` / `down` Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø´ØªØ±ÛŒ (Ø­Ø°Ù Ú©Ø§Ù…Ù„ Ú©Ø§Ù†ØªÛŒÙ†Ø±Ù‡Ø§ + Ú©Ø±ÙˆÙ† Ø¬Ø§Ø¨â€ŒÙ‡Ø§)
- Ø¨Ú©Ø§Ù¾â€ŒÚ¯ÛŒØ±ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ø² ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ùˆ Ø¯ÛŒØªØ§Ø¨ÛŒØ³â€ŒÙ‡Ø§ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†
- Ù…Ø¯ÛŒØ±ÛŒØª Ø®ÙˆØ¯Ú©Ø§Ø± Ú©Ø±ÙˆÙ† Ø¬Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¨Ú©Ø§Ù¾ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙ†Ø¸ÛŒÙ…Ø§Øª inventory
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ø§Ø² Git Branch Ùˆ Tag
- ØªØ³Øª Ú©Ø§Ù…Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± (Smoke, API, UI, Security, Performance, Load, Stress, Regression)
- Ú¯Ø²Ø§Ø±Ø´ HTML Ø²ÛŒØ¨Ø§ Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø± ØªØ³Øª
- Ø§Ú¯Ø± ØªØ³Øª fail Ø´Ø¯ â†’ Ø¯Ù¾Ù„ÙˆÛŒ Ù…ØªÙˆÙ‚Ù Ù…ÛŒØ´Ù‡ (fail-fast)

<!-- Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„: Ø²ÛŒØ±Ø³Ø§Ø®Øª -->
![Ansible](https://img.shields.io/badge/Ansible-2.16+-ee0000?logo=ansible&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-27.3+-2496ED?logo=docker&logoColor=white)
![Ubuntu](https://img.shields.io/badge/Ubuntu-24.04_LTS-E95420?logo=ubuntu&logoColor=white)
![Git](https://img.shields.io/badge/Git-F05032?logo=git&logoColor=white)
<br>
<!-- Ø±Ø¯ÛŒÙ Ø¯ÙˆÙ…: Ø¨Ú©â€ŒØ§Ù†Ø¯ -->
![PHP](https://img.shields.io/badge/PHP-8.3-777BB4?logo=php&logoColor=white)
![Laravel](https://img.shields.io/badge/Laravel-11-ff2d20?logo=laravel&logoColor=white)
![Symfony](https://img.shields.io/badge/Symfony-7-000000?logo=symfony&logoColor=white)
![CodeIgniter](https://img.shields.io/badge/CodeIgniter-4-DD4814?logo=codeigniter&logoColor=white)
<br>
<!-- Ø±Ø¯ÛŒÙ Ø³ÙˆÙ…: ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯ Ùˆ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ -->
![Vue.js](https://img.shields.io/badge/Vue.js-3-4fc08d?logo=vuedotjs&logoColor=white)
![Pinia](https://img.shields.io/badge/Pinia-2-fbbf24?logo=pinia&logoColor=black)
![Axios](https://img.shields.io/badge/Axios-0.28-5a29e4?logo=axios&logoColor=white)
![Socket.io](https://img.shields.io/badge/Socket.io-4-010101?logo=socket.io&logoColor=white)
<br>
<!-- Ø±Ø¯ÛŒÙ Ú†Ù‡Ø§Ø±Ù…: Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ùˆ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ -->
![Bootstrap](https://img.shields.io/badge/Bootstrap-5-563d7c?logo=bootstrap&logoColor=white)
![Composer](https://img.shields.io/badge/Composer-2.7-885630?logo=composer&logoColor=white)
![NPM](https://img.shields.io/badge/NPM-10-CB3837?logo=npm&logoColor=white)
![MySQL](https://img.shields.io/badge/MySQL-8-4479A1?logo=mysql&logoColor=white)
![Playwright](https://img.shields.io/badge/Playwright-1.56-45ba4b?logo=playwright&logoColor=white)

---

### Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù¾Ø±ÙˆÚ˜Ù‡

```bash
git clone https://github.com/samadelmakchi/leo.git
cd leo
```

---

### Ø³Ø§Ø®Øª Ú©Ù„ÛŒØ¯ SSH (id_rsa)

```bash
ssh-keygen -t ed25519 -C "leo@deploy" -f id_rsa -N ""
```

---

### Ø§ÙØ²ÙˆØ¯Ù† Ú©Ù„ÛŒØ¯ Ø¨Ù‡ GitHub
```bash
cat id_rsa.pub
```
Ù…Ø­ØªÙˆØ§ÛŒ Ø¨Ø§Ù„Ø§ Ø±Ùˆ Ú©Ù¾ÛŒ Ú©Ù† â†’ Ø¨Ù‡ GitHub â†’ Settings â†’ SSH and GPG keys â†’ New SSH key Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†

---

### Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡

```text
leo/
â”œâ”€â”€ playbook.yml
â”œâ”€â”€ inventory.yml
â”œâ”€â”€ id_rsa + id_rsa.pub
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ simnad_lms.sql
â”‚   â”œâ”€â”€ simnad_file.env
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tasks/
â”‚   â”œâ”€â”€ 09-deploy-containers.yml
â”‚   â”œâ”€â”€ 10-run-migrations.yml
â”‚   â””â”€â”€ 99-run-tests.yml
â”œâ”€â”€ tests/
â””â”€â”€ templates/
```
---

### Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡

```bash
# Ø¢Ù¾Ø¯ÛŒØª Ù‡Ù…Ù‡ Ù…Ø´ØªØ±ÛŒØ§Ù†
ansible-playbook -i inventory.yml playbook.yml

# Ø¢Ù¾Ø¯ÛŒØª ÙÙ‚Ø· ÛŒÚ© Ù…Ø´ØªØ±ÛŒ
ansible-playbook -i inventory.yml playbook.yml --limit simnad

# ÙÙ‚Ø· Ù…ÛŒÚ¯Ø±ÛŒØ´Ù† lms Ùˆ file
ansible-playbook -i inventory.yml playbook.yml --limit simnad -e "customer_lms_update=true customer_file_update=true"



# Ø®Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯Ù† Ú©Ø§Ù…Ù„ ÛŒÚ© Ù…Ø´ØªØ±ÛŒ (Ø­Ø°Ù Ú©Ø§Ù†ØªÛŒÙ†Ø±Ù‡Ø§ + Ú©Ø±ÙˆÙ† Ø¬Ø§Ø¨â€ŒÙ‡Ø§)
ansible-playbook -i inventory.yml playbook.yml --limit simnad --extra-vars "customer_state=down"



# Ø¯Ù¾Ù„ÙˆÛŒ Ùˆ ØªØ³Øª Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù…Ø´ØªØ±ÛŒ  Ø¨Ø§ Ú¯Ø²Ø§Ø±Ø´ HTML
ansible-playbook -i inventory.yml playbook.yml --limit simnad --extra-vars "customer_test_enabled=true"

# ÙÙ‚Ø· ØªØ³Øª Ø§Ø¬Ø±Ø§ Ú©Ù† (Ø¨Ø¯ÙˆÙ† Ø¯Ù¾Ù„ÙˆÛŒ Ù…Ø¬Ø¯Ø¯)
ansible-playbook -i inventory.yml playbook.yml --limit simnad --extra-vars "customer_test_enabled=true" --tags "test"

# Ø¯Ù¾Ù„ÙˆÛŒ Ùˆ ØªØ³Øª Ú©Ø§Ù…Ù„ Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù…Ø´ØªØ±ÛŒ  Ø¨Ø§ Ú¯Ø²Ø§Ø±Ø´ HTML Ùˆ Ø¨Ø§ Ù‡Ø± Ø®Ø·Ø§ÛŒÛŒ Ù…ØªÙˆÙ‚Ù Ø¨Ø´Ùˆ
ansible-playbook -i inventory.yml playbook.yml --limit simnad --extra-vars "customer_test_enabled=true customer_test_fail_fast=true"



# ÙÙ‚Ø· Ø¨Ú©Ø§Ù¾ Ø¨Ú¯ÛŒØ± (Ø¨Ø¯ÙˆÙ† ØªØ³Øª)
ansible-playbook -i inventory.yml playbook.yml --limit simnad --tags backup

```

### Ø¢Ù¾Ø¯ÛŒØª ÙÙ‚Ø· ÛŒÚ© Ø³Ø±ÙˆÛŒØ³ Ø®Ø§Øµ

Ø¯Ø± `inventory.yml` Ø¨Ø±Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ Ù…ÙˆØ±Ø¯Ù†Ø¸Ø±:
```bash
customer_gateway_update: true
customer_portal_update: false
customer_portal_frontend_update: true
```

---

### ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ù‡Ù… Ø¯Ø± inventory.yml

```bash
customer_state: "up"               # ÛŒØ§ "down"

# Ú©Ù†ØªØ±Ù„ Ø¢Ù¾Ø¯ÛŒØª Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§
customer_gateway_update: true
customer_portal_update: true
customer_portal_frontend_update: true

# Ú©Ù†ØªØ±Ù„ Ø¨Ú©Ø§Ù¾
customer_backup_enabled: true                     # ÙØ¹Ø§Ù„/ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¨Ú©Ø§Ù¾
customer_backup_keep: 7                           # Ú†Ù†Ø¯ ØªØ§ Ø¨Ú©Ø§Ù¾ Ø¢Ø®Ø± Ù†Ú¯Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø´ÙˆØ¯
customer_backup_cron_volumes: "0 3 * * 0"         # ÛŒÚ©Ø´Ù†Ø¨Ù‡â€ŒÙ‡Ø§ Ø³Ø§Ø¹Øª 03:00
customer_backup_cron_databases: "30 1,9,17 * * *" # Ù‡Ø± Ø±ÙˆØ² 01:30ØŒ 09:30ØŒ 17:30
```

---

### Ø³Ø§Ø®ØªØ§Ø± Ø±ÛŒØ³ØªÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± (Ù¾ÙˆØ´Ù‡ sql/)

```bash
sql/
â”œâ”€â”€ simnad_gateway.sql
â”œâ”€â”€ simnad_portal.sql
â”œâ”€â”€ simnad_lms.sql
â”œâ”€â”€ simnad_file.sql
â”œâ”€â”€ simnad_gateway_uploads.zip
â”œâ”€â”€ simnad_portal_uploads.zip
â”œâ”€â”€ simnad_lms_uploads.zip
â”œâ”€â”€ simnad_file_uploads.zip
â”œâ”€â”€ simnad_lms.env
â”œâ”€â”€ simnad_file.env
â””â”€â”€ default_gateway.sql   # ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ gateway
```
Ø§Ú¯Ø± ÙØ§ÛŒÙ„ Ù…Ø´ØªØ±ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ â†’ Ø±ÛŒØ³ØªÙˆØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯

Ø§Ú¯Ø± Ù†Ø¨ÙˆØ¯ â†’ Ù…ÛŒÚ¯Ø±ÛŒØ´Ù† Ø®ÙˆØ¯Ø´ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø±Ø§ Ù…ÛŒâ€ŒØ³Ø§Ø²Ø¯

---

## Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§

| Ù†ÙˆØ¹ Ú¯Ø²Ø§Ø±Ø´            | Ù…Ø³ÛŒØ±                                                 |
| -------------------- | ---------------------------------------------------- |
| Ú¯Ø²Ø§Ø±Ø´ ØªØ³Øª HTML       | `/home/calibri/log/test-reports/[Ù…Ø´ØªØ±ÛŒ]/report.html` |
| Ú¯Ø²Ø§Ø±Ø´ ØªØ³Øª JUnit (CI) | `/home/calibri/log/test-reports/[Ù…Ø´ØªØ±ÛŒ]/junit.xml`   |
| Ù„Ø§Ú¯ Ø¨Ú©Ø§Ù¾ Ø¯ÛŒØªØ§Ø¨ÛŒØ³     | `/home/calibri/log/backup/[Ù…Ø´ØªØ±ÛŒ]_databases.log`     |
| Ù„Ø§Ú¯ Ø¨Ú©Ø§Ù¾ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§      | `/home/calibri/log/backup/[Ù…Ø´ØªØ±ÛŒ]_volumes.log`       |
| Ù„Ø§Ú¯ Ù†ØµØ¨ Playwright   | `/var/log/playwright-install.log`                    |

> Ù…Ø«Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ù…Ø´ØªØ±ÛŒ `simnad`:
> - Ú¯Ø²Ø§Ø±Ø´ ØªØ³Øª: `/home/calibri/log/test-reports/simnad/report.html`
> - Ù„Ø§Ú¯ Ø¨Ú©Ø§Ù¾: `/home/calibri/log/backup/simnad_databases.log`

---

## ØªÙ†Ø¸ÛŒÙ… Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ† Ø¯Ø± DirectAdmin

| Ø³Ø±ÙˆÛŒØ³           | Ù¾ÙˆØ±Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ | Ù…Ø«Ø§Ù„ Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ†              | ØªÙˆØ¶ÛŒØ­Ø§Øª               |
| --------------- | ----------- | -------------------------- | --------------------- |
| Gateway         | 8061+       | `calibri.simnad.com`       | Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø§ØµÙ„ÛŒ       |
| Portal Backend  | 7061+       | `backendportal.simnad.com` | Ø¨Ú©â€ŒØ§Ù†Ø¯ Symfony         |
| Portal Frontend | 6061+       | `portal.simnad.com`        | ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯ React/Vue    |
| LMS             | 9061+       | `lms.simnad.com`           | Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ  |
| File Storage    | 10061+      | `files.simnad.com`         | ÙØ§ÛŒÙ„â€ŒÙ…Ù†ÛŒØ¬Ø± Ùˆ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ |

### Ù†Ø­ÙˆÙ‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ø± DirectAdmin:
1. ÙˆØ§Ø±Ø¯ Ù¾Ù†Ù„ DirectAdmin Ø´ÙˆÛŒØ¯ â†’ **DNS Management**  
2. Ø±ÙˆÛŒ **Add Record** Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯  
3. Ù†ÙˆØ¹: `A` â†’ Name: `calibri` â†’ Value: `185.255.89.160` â†’ Ø°Ø®ÛŒØ±Ù‡  
4. Ù‡Ù…ÛŒÙ† Ú©Ø§Ø± Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ø¨Ù‚ÛŒÙ‡ Ø³Ø§Ø¨â€ŒØ¯Ø§Ù…ÛŒÙ†â€ŒÙ‡Ø§ ØªÚ©Ø±Ø§Ø± Ú©Ù†ÛŒØ¯

DNS Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ø¨ÛŒÙ† Û± ØªØ§ Û±Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ù¾Ø±ÙˆÙ¾Ø§Ú¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯.

---

### Ù…Ø³ÛŒØ± Ø°Ø®ÛŒØ±Ù‡ Ø¨Ú©Ø§Ù¾â€ŒÙ‡Ø§

```
/home/calibri/backup/[customer_name]/2025-12-02-10-30-00/
```

---

cd ../leo/ui
python3 -m venv venv
source venv/bin/activate
python app.py

pip install -r requirements.txt

**Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ ğŸ–¤ ØªÙˆØ³Ø· ØµÙ…Ø¯ Ø§Ù„Ù…Ú©Ú†ÛŒ**  
